name: ğŸ¤– Auto-Merge PR

on:
  workflow_run:
    workflows:
      - "âœ… PR Validation"
      - "ğŸ”’ğŸš€ Security & Performance"
      - "ğŸ”’ Dependency Review"
      - "ğŸ³ Docker Validation"
    types:
      - completed
    branches:
      - main

permissions:
  contents: write
  pull-requests: write
  checks: read

jobs:
  auto-merge:
    uses: Philippe-arnd/reusable-workflow-vibecoded/.github/workflows/reusable-auto-merge.yml@main
    with:
      required-checks: |
        âœ… Quick Checks
        ğŸ§ª Vitest Tests
        ğŸ”’ RLS Tests
        ğŸ”‘ Secret Detection
        ğŸ›¡ï¸ Security Scan
        ğŸ” Review Dependencies for Vulnerabilities
      conditional-checks: |
        ğŸ“¦ Bundle Size
        Build & Test Docker Images
      merge-method: squash
      base-branch: main
      block-label: major-update
      triggering-conclusion: ${{ github.event.workflow_run.conclusion }}
      triggering-branch: ${{ github.event.workflow_run.head_branch }}
