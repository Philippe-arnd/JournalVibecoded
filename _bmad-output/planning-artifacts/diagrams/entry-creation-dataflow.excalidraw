{
  "type": "excalidraw",
  "version": 2,
  "source": "https://excalidraw.com",
  "elements": [
    {
      "type": "text",
      "id": "title",
      "x": 400,
      "y": 30,
      "width": 600,
      "height": 40,
      "text": "Entry Creation & AI Feedback - Data Flow",
      "fontSize": 24,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#37352F"
    },
    {
      "type": "ellipse",
      "id": "user-start",
      "x": 100,
      "y": 120,
      "width": 120,
      "height": 120,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#37352F",
      "backgroundColor": "#FBF9F6",
      "label": {
        "text": "User Opens\nApp",
        "fontSize": 16,
        "fontFamily": 1,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "rectangle",
      "id": "step-1",
      "x": 300,
      "y": 120,
      "width": 180,
      "height": 100,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#2EAADC",
      "backgroundColor": "#E3F2FD",
      "label": {
        "text": "1. Check Auth\n\nsupabase.auth\n  .getSession()",
        "fontSize": 14,
        "fontFamily": 3,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "rectangle",
      "id": "step-2",
      "x": 550,
      "y": 120,
      "width": 200,
      "height": 100,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#3ECF8E",
      "backgroundColor": "#E8F5E9",
      "label": {
        "text": "2. Load/Create Entry\n\nGET /entries\n  ?date=today\n  &user_id=xxx",
        "fontSize": 14,
        "fontFamily": 3,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "rectangle",
      "id": "step-3",
      "x": 300,
      "y": 280,
      "width": 220,
      "height": 100,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#D9730D",
      "backgroundColor": "#FFF3E0",
      "label": {
        "text": "3. User Types\n    (Section 1-4)\n\nLocal state update\n→ Trigger debounced\n   auto-save (500ms)",
        "fontSize": 14,
        "fontFamily": 3,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "rectangle",
      "id": "step-4",
      "x": 580,
      "y": 280,
      "width": 180,
      "height": 100,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#3ECF8E",
      "backgroundColor": "#E8F5E9",
      "label": {
        "text": "4. Auto-Save\n\nPATCH /entries/:id\n{\n  professional_recap,\n  ...sections\n}",
        "fontSize": 14,
        "fontFamily": 3,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "rectangle",
      "id": "step-5",
      "x": 300,
      "y": 440,
      "width": 220,
      "height": 100,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#E03E3E",
      "backgroundColor": "#FFEBEE",
      "label": {
        "text": "5. Complete Entry\n\nPATCH /entries/:id\n{\n  completed: true\n}",
        "fontSize": 14,
        "fontFamily": 3,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "rectangle",
      "id": "step-6",
      "x": 580,
      "y": 440,
      "width": 200,
      "height": 120,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#FFB224",
      "backgroundColor": "#FFF8E1",
      "label": {
        "text": "6. Generate AI\n    Feedback\n\nPOST /ai-feedback\n{\n  entry,\n  pastEntries\n}\n\n→ Claude API",
        "fontSize": 14,
        "fontFamily": 3,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "rectangle",
      "id": "step-7",
      "x": 840,
      "y": 440,
      "width": 200,
      "height": 120,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#0F7B6C",
      "backgroundColor": "#E0F2F1",
      "label": {
        "text": "7. Display Feedback\n\n+ Update streak\n+ Show progress bar\n  (if <7 entries)\n+ Cited entries\n  (if 7+ entries)",
        "fontSize": 14,
        "fontFamily": 3,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "rectangle",
      "id": "step-8",
      "x": 840,
      "y": 620,
      "width": 200,
      "height": 80,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#787774",
      "backgroundColor": "#F5F5F5",
      "label": {
        "text": "8. Update Stats\n\nTrigger:\nupdate_user_stats()",
        "fontSize": 14,
        "fontFamily": 3,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "ellipse",
      "id": "user-end",
      "x": 600,
      "y": 620,
      "width": 120,
      "height": 120,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#37352F",
      "backgroundColor": "#E8F5E9",
      "label": {
        "text": "User Sees\nFeedback",
        "fontSize": 16,
        "fontFamily": 1,
        "textAlign": "center",
        "verticalAlign": "middle"
      }
    },
    {
      "type": "arrow",
      "id": "flow-1",
      "x": 220,
      "y": 170,
      "width": 60,
      "height": 0,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "type": "arrow",
      "id": "flow-2",
      "x": 480,
      "y": 170,
      "width": 50,
      "height": 0,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "type": "arrow",
      "id": "flow-3",
      "x": 650,
      "y": 220,
      "width": 0,
      "height": 40,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "type": "arrow",
      "id": "flow-4",
      "x": 520,
      "y": 330,
      "width": 40,
      "height": 0,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "label": {
        "text": "500ms\ndebounce",
        "fontSize": 12
      }
    },
    {
      "type": "arrow",
      "id": "flow-5",
      "x": 410,
      "y": 380,
      "width": 0,
      "height": 40,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "label": {
        "text": "User taps\n[Complete]",
        "fontSize": 12
      }
    },
    {
      "type": "arrow",
      "id": "flow-6",
      "x": 520,
      "y": 490,
      "width": 40,
      "height": 0,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "type": "arrow",
      "id": "flow-7",
      "x": 780,
      "y": 500,
      "width": 40,
      "height": 0,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "label": {
        "text": "<3s",
        "fontSize": 12
      }
    },
    {
      "type": "arrow",
      "id": "flow-8",
      "x": 840,
      "y": 500,
      "width": -100,
      "height": 160,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "type": "arrow",
      "id": "flow-9",
      "x": 940,
      "y": 560,
      "width": 0,
      "height": 40,
      "strokeColor": "#37352F",
      "strokeWidth": 2,
      "startArrowhead": null,
      "endArrowhead": "arrow",
      "strokeStyle": "dashed",
      "label": {
        "text": "Trigger",
        "fontSize": 12
      }
    },
    {
      "type": "text",
      "id": "legend",
      "x": 100,
      "y": 600,
      "width": 280,
      "height": 120,
      "text": "Performance Targets:\n\n• Auto-save: <100ms (local)\n• DB save: <500ms (online)\n• AI feedback: <3s\n• Total flow: <5 minutes",
      "fontSize": 13,
      "fontFamily": 1,
      "textAlign": "left",
      "strokeColor": "#787774",
      "backgroundColor": "#FAFAFA",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "type": "text",
      "id": "notes",
      "x": 100,
      "y": 440,
      "width": 150,
      "height": 120,
      "text": "Key Features:\n\n✓ Optimistic UI\n✓ Debounced\n  auto-save\n✓ Progressive\n  AI depth",
      "fontSize": 13,
      "fontFamily": 1,
      "textAlign": "left",
      "strokeColor": "#2EAADC",
      "backgroundColor": "#E3F2FD",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "type": "rectangle",
      "id": "claude-api-detail",
      "x": 820,
      "y": 280,
      "width": 240,
      "height": 100,
      "fillStyle": "solid",
      "strokeWidth": 2,
      "strokeColor": "#D9730D",
      "backgroundColor": "#FFF3E0",
      "strokeStyle": "dashed",
      "label": {
        "text": "Claude API Logic:\n\nIF total_entries < 7:\n  → Simple encouragement\nELSE:\n  → Pattern recognition\n  → Cite past entries",
        "fontSize": 13,
        "fontFamily": 3,
        "textAlign": "left",
        "verticalAlign": "top"
      }
    },
    {
      "type": "arrow",
      "id": "flow-api-logic",
      "x": 680,
      "y": 410,
      "width": 120,
      "height": -80,
      "strokeColor": "#D9730D",
      "strokeWidth": 1,
      "strokeStyle": "dashed",
      "startArrowhead": null,
      "endArrowhead": "arrow"
    }
  ],
  "appState": {
    "viewBackgroundColor": "#ffffff",
    "gridSize": 20
  }
}